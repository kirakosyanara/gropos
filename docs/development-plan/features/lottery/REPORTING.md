# Lottery Reporting - Daily Reports and Commission Tracking

**Version:** 2.0 (Kotlin/Compose)  
**Status:** Specification Document  
**Purpose:** Define lottery reporting requirements for operations and compliance

---

## Overview

Lottery reporting provides visibility into:

1. **Daily Operations** - Sales, payouts, net activity
2. **Inventory Status** - Packs active, tickets remaining
3. **Commission Tracking** - Earned commission on sales
4. **Employee Activity** - Who processed which transactions
5. **Compliance Records** - Large payout documentation

---

## Report Types

### 1. Daily Lottery Summary

Primary operational report showing day's lottery activity.

```
════════════════════════════════════════════════════════════════════════════════
                         DAILY LOTTERY SUMMARY REPORT
                              January 1, 2026
                           Gro Grocery - Store #001
════════════════════════════════════════════════════════════════════════════════

SALES SUMMARY
─────────────────────────────────────────────────────────────────────────────────
                              Transactions      Amount        Commission
─────────────────────────────────────────────────────────────────────────────────
Scratchers                          45        $  892.00      $   48.98
Draw Games                          23        $   72.00      $    3.60
─────────────────────────────────────────────────────────────────────────────────
TOTAL SALES                         68        $  964.00      $   52.58
─────────────────────────────────────────────────────────────────────────────────

PAYOUTS SUMMARY
─────────────────────────────────────────────────────────────────────────────────
                              Transactions      Amount
─────────────────────────────────────────────────────────────────────────────────
Tier 1 (< $50)                      12        $  187.00
Tier 2 ($50-$599)                    3        $  275.00
Tier 3 (≥ $600)                      0        $    0.00
─────────────────────────────────────────────────────────────────────────────────
TOTAL PAYOUTS                       15        $  462.00
─────────────────────────────────────────────────────────────────────────────────

NET LOTTERY ACTIVITY
─────────────────────────────────────────────────────────────────────────────────
Total Sales:                                  $  964.00
Less: Total Payouts:                          $ (462.00)
─────────────────────────────────────────────────────────────────────────────────
NET CASH IMPACT:                              $  502.00
Estimated Commission:                         $   52.58
─────────────────────────────────────────────────────────────────────────────────

════════════════════════════════════════════════════════════════════════════════
Report Generated: 01/01/2026 11:59 PM
Generated By: System (End of Day)
════════════════════════════════════════════════════════════════════════════════
```

### 2. Payout Detail Report

Lists all payouts with transaction details.

```
════════════════════════════════════════════════════════════════════════════════
                           LOTTERY PAYOUT DETAIL REPORT
                                January 1, 2026
════════════════════════════════════════════════════════════════════════════════

TIME       RECEIPT#           AMOUNT     TIER    EMPLOYEE    APPROVAL
─────────────────────────────────────────────────────────────────────────────────
09:15 AM   LP-20260101-001   $   12.00   1       John D.     -
09:45 AM   LP-20260101-002   $   25.00   1       John D.     -
10:22 AM   LP-20260101-003   $    5.00   1       Sarah M.    -
10:55 AM   LP-20260101-004   $   75.00   2       Sarah M.    -
11:30 AM   LP-20260101-005   $   15.00   1       John D.     -
─────────────────────────────────────────────────────────────────────────────────
TOTAL:                       $  132.00   5 transactions

TIER SUMMARY:
Tier 1 (< $50):     4 payouts    $   57.00
Tier 2 ($50-$599):  1 payout     $   75.00
Tier 3 (≥ $600):    0 payouts    $    0.00

════════════════════════════════════════════════════════════════════════════════
```

### 3. Employee Activity Report

Shows lottery activity by employee.

```
════════════════════════════════════════════════════════════════════════════════
                         EMPLOYEE LOTTERY ACTIVITY REPORT
                                January 1, 2026
════════════════════════════════════════════════════════════════════════════════

JOHN D. (Employee #42)
─────────────────────────────────────────────────────────────────────────────────
Sales Transactions:      18          $  312.00
Payout Transactions:      5          $  159.00
Net Cash Activity:                   $  153.00

SARAH M. (Employee #15)
─────────────────────────────────────────────────────────────────────────────────
Sales Transactions:      25          $  398.00
Payout Transactions:      5          $  133.00
Net Cash Activity:                   $  265.00

════════════════════════════════════════════════════════════════════════════════
STORE TOTAL:
Sales:                   43          $  710.00
Payouts:                 10          $  292.00
Net:                                 $  418.00
════════════════════════════════════════════════════════════════════════════════
```

---

## Data Model

### LotteryDailyReport

```kotlin
data class LotteryDailyReport(
    val id: Int,
    val branchId: Int,
    val reportDate: LocalDate,
    
    // Sales
    val scratcherSalesCount: Int = 0,
    val scratcherSalesAmount: BigDecimal = BigDecimal.ZERO,
    val drawGameSalesCount: Int = 0,
    val drawGameSalesAmount: BigDecimal = BigDecimal.ZERO,
    val totalSalesCount: Int = 0,
    val totalSalesAmount: BigDecimal = BigDecimal.ZERO,
    
    // Payouts
    val tier1PayoutCount: Int = 0,
    val tier1PayoutAmount: BigDecimal = BigDecimal.ZERO,
    val tier2PayoutCount: Int = 0,
    val tier2PayoutAmount: BigDecimal = BigDecimal.ZERO,
    val tier3PayoutCount: Int = 0,
    val tier3PayoutAmount: BigDecimal = BigDecimal.ZERO,
    val totalPayoutCount: Int = 0,
    val totalPayoutAmount: BigDecimal = BigDecimal.ZERO,
    
    // Net
    val netCashImpact: BigDecimal = BigDecimal.ZERO,
    val estimatedCommission: BigDecimal = BigDecimal.ZERO,
    
    // Metadata
    val generatedDate: OffsetDateTime = OffsetDateTime.now(),
    val generatedByEmployeeId: Int? = null,
    val isFinal: Boolean = false
)
```

---

## API Endpoints

### GET /lottery/report/daily

Get daily lottery summary.

**Request:**
```
GET /lottery/report/daily?branchId=1&date=2026-01-01
```

**Response:**
```json
{
  "branchId": 1,
  "reportDate": "2026-01-01",
  "sales": {
    "scratchers": {
      "count": 45,
      "amount": 892.00
    },
    "drawGames": {
      "count": 23,
      "amount": 72.00
    },
    "total": {
      "count": 68,
      "amount": 964.00
    }
  },
  "payouts": {
    "tier1": { "count": 12, "amount": 187.00 },
    "tier2": { "count": 3, "amount": 275.00 },
    "tier3": { "count": 0, "amount": 0.00 },
    "total": { "count": 15, "amount": 462.00 }
  },
  "netCashImpact": 502.00,
  "estimatedCommission": 52.58
}
```

### GET /lottery/report/payouts

Get payout detail report.

**Request:**
```
GET /lottery/report/payouts?branchId=1&startDate=2026-01-01&endDate=2026-01-01
```

**Response:**
```json
{
  "payouts": [
    {
      "transactionId": 12345,
      "receiptNumber": "LP-20260101-001",
      "transactionDate": "2026-01-01T09:15:00-08:00",
      "amount": 12.00,
      "tier": "TIER_1",
      "employeeId": 42,
      "employeeName": "John D.",
      "ticketSerialNumber": "1234-567890-012345"
    }
  ],
  "summary": {
    "tier1": { "count": 12, "amount": 187.00 },
    "tier2": { "count": 3, "amount": 275.00 },
    "tier3": { "count": 0, "amount": 0.00 },
    "total": { "count": 15, "amount": 462.00 }
  }
}
```

### GET /lottery/report/commission

Get commission report for a period.

**Request:**
```
GET /lottery/report/commission?branchId=1&startDate=2025-12-26&endDate=2026-01-01
```

**Response:**
```json
{
  "branchId": 1,
  "periodStart": "2025-12-26",
  "periodEnd": "2026-01-01",
  "byGame": [
    {
      "gameId": 1,
      "gameName": "$1 Lucky 7s",
      "salesAmount": 224.00,
      "commissionRate": 0.0500,
      "commissionAmount": 11.20
    }
  ],
  "totals": {
    "salesAmount": 6735.00,
    "commissionAmount": 376.63
  }
}
```

---

## Report Generation

### Scheduled Reports

| Report | Schedule | Retention |
|--------|----------|-----------|
| Daily Summary | End of day (auto) | 2 years |
| Weekly Commission | Sunday 11:59 PM | 7 years |
| Monthly Summary | 1st of month | 7 years |
| Inventory Snapshot | Daily (auto) | 1 year |

### Manual Reports

Reports can be generated on-demand with date range parameters:
- Daily summary (any past date)
- Payout detail (date range)
- Commission report (date range)
- Inventory audit (point-in-time)

---

## Report Access

| Role | Reports Available |
|------|-------------------|
| Cashier | None (view current day totals only) |
| Supervisor | Daily summary, Payout detail |
| Manager | All reports |
| Owner/Admin | All reports + export |

---

## Export Formats

- **PDF** - Formatted reports for printing
- **CSV** - Data export for spreadsheets
- **JSON** - API response for integrations

---

## Related Documentation

- [OVERVIEW.md](./OVERVIEW.md) - Architecture overview
- [SALES.md](./SALES.md) - Sales transaction details
- [PAYOUTS.md](./PAYOUTS.md) - Payout transaction details
- [COMPLIANCE.md](./COMPLIANCE.md) - Regulatory reporting requirements
- [API.md](./API.md) - Complete API specification

---

*Last Updated: January 2026*

